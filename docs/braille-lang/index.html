<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚°Ç‚°≤‚°°‚°©‚°¨‚°¨‚°• BrailleLang ‚Äî AI-Native Programming in Braille</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #0a0e17;
            --bg-card: #111827;
            --bg-code: #0d1321;
            --border: #1e293b;
            --border-glow: #3b82f680;
            --text: #e2e8f0;
            --text-dim: #94a3b8;
            --text-bright: #f8fafc;
            --accent: #3b82f6;
            --accent-glow: #3b82f640;
            --green: #22c55e;
            --green-dim: #22c55e40;
            --purple: #a78bfa;
            --purple-dim: #a78bfa40;
            --orange: #f97316;
            --orange-dim: #f9731640;
            --pink: #ec4899;
            --red: #ef4444;
            --cyan: #06b6d4;
            --yellow: #eab308;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* ‚îÄ‚îÄ Hero ‚îÄ‚îÄ */
        .hero {
            position: relative;
            padding: 80px 20px 60px;
            text-align: center;
            overflow: hidden;
        }
        .hero::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(ellipse at 50% 0%, var(--accent-glow) 0%, transparent 50%),
                        radial-gradient(ellipse at 20% 50%, var(--purple-dim) 0%, transparent 40%),
                        radial-gradient(ellipse at 80% 50%, var(--green-dim) 0%, transparent 40%);
            animation: heroGlow 8s ease-in-out infinite alternate;
            z-index: 0;
        }
        @keyframes heroGlow {
            0% { transform: translate(0, 0) scale(1); }
            100% { transform: translate(-2%, -3%) scale(1.05); }
        }
        .hero > * { position: relative; z-index: 1; }
        .hero h1 {
            font-size: 3.5rem;
            font-weight: 800;
            letter-spacing: -0.02em;
            margin-bottom: 8px;
            background: linear-gradient(135deg, var(--text-bright), var(--accent), var(--purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .hero .braille-title {
            font-family: 'JetBrains Mono', monospace;
            font-size: 2rem;
            color: var(--accent);
            margin-bottom: 16px;
            letter-spacing: 0.15em;
            text-shadow: 0 0 30px var(--accent-glow);
        }
        .hero p {
            font-size: 1.15rem;
            color: var(--text-dim);
            max-width: 640px;
            margin: 0 auto 32px;
        }
        .hero-badges {
            display: flex;
            gap: 12px;
            justify-content: center;
            flex-wrap: wrap;
        }
        .badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 14px;
            border-radius: 999px;
            font-size: 0.8rem;
            font-weight: 600;
            border: 1px solid var(--border);
            background: var(--bg-card);
        }
        .badge.ai { border-color: var(--purple); color: var(--purple); }
        .badge.braille { border-color: var(--accent); color: var(--accent); }
        .badge.open { border-color: var(--green); color: var(--green); }

        /* ‚îÄ‚îÄ Container ‚îÄ‚îÄ */
        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* ‚îÄ‚îÄ Sections ‚îÄ‚îÄ */
        section {
            padding: 60px 0;
        }
        section h2 {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--text-bright);
        }
        section .subtitle {
            color: var(--text-dim);
            margin-bottom: 32px;
            font-size: 1rem;
        }

        /* ‚îÄ‚îÄ Concept Grid ‚îÄ‚îÄ */
        .concept-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 12px;
            margin-top: 24px;
        }
        .concept-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 16px;
            transition: all 0.2s;
        }
        .concept-card:hover {
            border-color: var(--accent);
            box-shadow: 0 0 20px var(--accent-glow);
            transform: translateY(-2px);
        }
        .concept-card .braille-char {
            font-size: 2rem;
            font-family: 'JetBrains Mono', monospace;
            margin-bottom: 4px;
        }
        .concept-card .concept-name {
            font-weight: 600;
            font-size: 0.85rem;
            color: var(--purple);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        .concept-card .prog-role {
            font-size: 0.8rem;
            color: var(--text-dim);
            margin-top: 2px;
        }
        .concept-card .js-equiv {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            color: var(--green);
            margin-top: 4px;
        }

        /* ‚îÄ‚îÄ Playground ‚îÄ‚îÄ */
        .playground {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            overflow: hidden;
        }
        .playground-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 20px;
            border-bottom: 1px solid var(--border);
            background: var(--bg-code);
        }
        .playground-header h3 {
            font-size: 0.9rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .playground-tabs {
            display: flex;
            gap: 4px;
        }
        .playground-tab {
            padding: 6px 14px;
            border-radius: 8px;
            font-size: 0.78rem;
            font-weight: 500;
            cursor: pointer;
            border: 1px solid transparent;
            background: transparent;
            color: var(--text-dim);
            transition: all 0.15s;
        }
        .playground-tab:hover { color: var(--text); background: var(--border); }
        .playground-tab.active {
            color: var(--accent);
            background: var(--accent-glow);
            border-color: var(--accent);
        }
        .playground-body {
            display: flex;
            min-height: 340px;
        }
        @media (max-width: 768px) {
            .playground-body { flex-direction: column; }
        }
        .editor-pane, .output-pane {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        .editor-pane {
            border-right: 1px solid var(--border);
        }
        @media (max-width: 768px) {
            .editor-pane { border-right: none; border-bottom: 1px solid var(--border); }
        }
        .pane-label {
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--text-dim);
            padding: 8px 16px 4px;
        }
        #editor {
            flex: 1;
            width: 100%;
            min-height: 280px;
            padding: 8px 16px;
            background: transparent;
            color: var(--text-bright);
            border: none;
            outline: none;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.8;
            resize: none;
            tab-size: 2;
        }
        #output {
            flex: 1;
            padding: 8px 16px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            line-height: 1.7;
            white-space: pre-wrap;
            overflow-y: auto;
            color: var(--green);
            min-height: 280px;
        }
        #output .error { color: var(--red); }
        #output .info { color: var(--text-dim); }
        #output .ai { color: var(--purple); }

        .playground-footer {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 8px;
            padding: 10px 16px;
            border-top: 1px solid var(--border);
            background: var(--bg-code);
            flex-wrap: wrap;
        }
        .btn {
            padding: 8px 20px;
            border-radius: 8px;
            font-size: 0.82rem;
            font-weight: 600;
            cursor: pointer;
            border: 1px solid var(--border);
            transition: all 0.15s;
            font-family: 'Inter', sans-serif;
        }
        .btn-primary {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
        }
        .btn-primary:hover {
            background: #2563eb;
            box-shadow: 0 0 20px var(--accent-glow);
        }
        .btn-secondary {
            background: var(--bg-card);
            color: var(--text);
        }
        .btn-secondary:hover { border-color: var(--text-dim); }
        .btn-group { display: flex; gap: 8px; flex-wrap: wrap; }
        .stats {
            font-size: 0.75rem;
            color: var(--text-dim);
            font-family: 'JetBrains Mono', monospace;
        }

        /* ‚îÄ‚îÄ Examples ‚îÄ‚îÄ */
        .example-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 16px;
            margin-top: 24px;
        }
        .example-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.2s;
        }
        .example-card:hover {
            border-color: var(--accent);
            box-shadow: 0 0 20px var(--accent-glow);
        }
        .example-card .example-title {
            padding: 14px 16px 8px;
            font-weight: 600;
            font-size: 0.95rem;
            color: var(--text-bright);
        }
        .example-card .example-desc {
            padding: 0 16px 8px;
            font-size: 0.8rem;
            color: var(--text-dim);
        }
        .example-card pre {
            padding: 10px 16px 14px;
            background: var(--bg-code);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.78rem;
            line-height: 1.7;
            color: var(--cyan);
            overflow-x: auto;
            border-top: 1px solid var(--border);
        }

        /* ‚îÄ‚îÄ Reference Table ‚îÄ‚îÄ */
        .ref-section { margin-top: 32px; }
        .ref-section h3 {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--text-bright);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 24px;
        }
        th, td {
            text-align: left;
            padding: 10px 14px;
            border-bottom: 1px solid var(--border);
            font-size: 0.85rem;
        }
        th {
            color: var(--text-dim);
            font-weight: 600;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.08em;
        }
        td:first-child {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.3rem;
            color: var(--accent);
        }
        td:nth-child(3) {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            color: var(--green);
        }

        /* ‚îÄ‚îÄ Encoder ‚îÄ‚îÄ */
        .encoder-row {
            display: flex;
            gap: 16px;
            margin-top: 16px;
            align-items: stretch;
        }
        @media (max-width: 600px) {
            .encoder-row { flex-direction: column; }
        }
        .encoder-box {
            flex: 1;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 16px;
        }
        .encoder-box label {
            display: block;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: var(--text-dim);
            margin-bottom: 8px;
        }
        .encoder-box textarea {
            width: 100%;
            min-height: 80px;
            background: var(--bg-code);
            color: var(--text-bright);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 10px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            resize: vertical;
            outline: none;
        }
        .encoder-box textarea:focus { border-color: var(--accent); }

        /* ‚îÄ‚îÄ Architecture ‚îÄ‚îÄ */
        .arch-flow {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            flex-wrap: wrap;
            margin: 24px 0;
        }
        .arch-node {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 12px 20px;
            font-size: 0.85rem;
            font-weight: 600;
            text-align: center;
        }
        .arch-node .mono {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            color: var(--text-dim);
            margin-top: 2px;
        }
        .arch-arrow {
            font-size: 1.2rem;
            color: var(--accent);
        }

        /* ‚îÄ‚îÄ Footer ‚îÄ‚îÄ */
        footer {
            text-align: center;
            padding: 40px 20px;
            border-top: 1px solid var(--border);
            color: var(--text-dim);
            font-size: 0.85rem;
        }
        footer a { color: var(--accent); text-decoration: none; }
        footer a:hover { text-decoration: underline; }

        /* ‚îÄ‚îÄ SAL Chat ‚îÄ‚îÄ */
        .sal-chat {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 600px;
        }
        .sal-chat-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 14px 20px;
            border-bottom: 1px solid var(--border);
            background: var(--bg-code);
        }
        .sal-chat-header h3 { font-size: 0.95rem; font-weight: 700; display: flex; align-items: center; gap: 8px; }
        .sal-chat-header .sal-status { font-size: 0.7rem; color: var(--green); font-weight: 500; }
        .sal-chat-header .sal-status.offline { color: var(--red); }
        .sal-messages {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        .sal-msg {
            max-width: 85%;
            padding: 12px 16px;
            border-radius: 12px;
            font-size: 0.88rem;
            line-height: 1.6;
            white-space: pre-wrap;
            word-break: break-word;
        }
        .sal-msg.sal {
            align-self: flex-start;
            background: linear-gradient(135deg, #1e293b, #0f172a);
            border: 1px solid var(--border);
            color: var(--text);
        }
        .sal-msg.sal .sal-name { color: var(--accent); font-weight: 700; font-size: 0.75rem; margin-bottom: 4px; display: block; }
        .sal-msg.user {
            align-self: flex-end;
            background: var(--accent);
            color: white;
            border: 1px solid transparent;
        }
        .sal-msg .br-code {
            display: block;
            margin: 8px 0;
            padding: 10px 12px;
            background: var(--bg-code);
            border: 1px solid var(--border);
            border-radius: 8px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.82rem;
            color: var(--cyan);
            cursor: pointer;
            transition: border-color 0.2s;
            position: relative;
        }
        .sal-msg .br-code:hover { border-color: var(--accent); }
        .sal-msg .br-code::after {
            content: '‚†∑ Load into playground';
            position: absolute;
            top: 4px;
            right: 8px;
            font-size: 0.65rem;
            color: var(--text-dim);
            font-family: 'Inter', sans-serif;
        }
        .sal-msg .br-code:hover::after { color: var(--accent); }
        .sal-chat-input {
            display: flex;
            gap: 8px;
            padding: 12px 16px;
            border-top: 1px solid var(--border);
            background: var(--bg-code);
        }
        .sal-chat-input input {
            flex: 1;
            padding: 10px 14px;
            border-radius: 10px;
            border: 1px solid var(--border);
            background: var(--bg-card);
            color: var(--text-bright);
            font-family: 'Inter', sans-serif;
            font-size: 0.88rem;
            outline: none;
        }
        .sal-chat-input input:focus { border-color: var(--accent); }
        .sal-chat-input input::placeholder { color: var(--text-dim); }
        .sal-chat-input button {
            padding: 10px 20px;
            border-radius: 10px;
            border: none;
            background: var(--accent);
            color: white;
            font-weight: 600;
            font-size: 0.85rem;
            cursor: pointer;
            transition: background 0.15s;
            font-family: 'Inter', sans-serif;
        }
        .sal-chat-input button:hover { background: #2563eb; }
        .sal-chat-input button:disabled { opacity: 0.5; cursor: not-allowed; }
        .sal-key-banner {
            padding: 12px 16px;
            background: var(--orange-dim);
            border-bottom: 1px solid var(--orange);
            font-size: 0.82rem;
            display: flex;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
        }
        .sal-key-banner input {
            flex: 1;
            min-width: 200px;
            padding: 6px 10px;
            border-radius: 6px;
            border: 1px solid var(--orange);
            background: var(--bg-code);
            color: var(--text-bright);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.78rem;
            outline: none;
        }
        .sal-key-banner button {
            padding: 6px 14px;
            border-radius: 6px;
            border: none;
            background: var(--orange);
            color: white;
            font-weight: 600;
            font-size: 0.78rem;
            cursor: pointer;
        }
        .sal-typing { color: var(--text-dim); font-style: italic; font-size: 0.82rem; padding: 8px 16px; }

        /* ‚îÄ‚îÄ Scrollbar ‚îÄ‚îÄ */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: var(--bg); }
        ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--text-dim); }
    </style>
</head>
<body>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê HERO ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="hero">
    <div class="braille-title">‚°Ç‚°≤‚°°‚°©‚°¨‚°¨‚°•</div>
    <h1>BrailleLang</h1>
    <p>An AI-native programming language encoded entirely in Unicode Braille (U+2800‚ÄìU+28FF). Every keyword is a concept. Every program is tactile.</p>
    <div class="hero-badges">
        <span class="badge braille">‚†† AI-Native Primitives</span>
        <span class="badge ai">‚£† 256 Braille Patterns</span>
        <span class="badge open">‚†É Open Source</span>
    </div>
</div>

<div class="container">

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PLAYGROUND ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="playground">
    <h2>‚†∏ Playground</h2>
    <p class="subtitle">Write and run BrailleLang code directly in your browser.</p>
    <div class="playground">
        <div class="playground-header">
            <h3>‚†∞ Editor</h3>
            <div class="playground-tabs">
                <button class="playground-tab active" data-view="run">Run</button>
                <button class="playground-tab" data-view="tokens">Tokens</button>
                <button class="playground-tab" data-view="ast">AST</button>
                <button class="playground-tab" data-view="js">‚Üí JS</button>
                <button class="playground-tab" data-view="sal">‚£† SAL</button>
            </div>
        </div>
        <div class="playground-body">
            <div class="editor-pane">
                <div class="pane-label">Source (.br)</div>
                <textarea id="editor" spellcheck="false">‚£Ä Hello World in BrailleLang ‚£Ä

‚†∞ ‚†£ ‚†∂‚°à‚°•‚°¨‚°¨‚°Ø‚††‚°∑‚°Ø‚°≤‚°¨‚°§‚†∂ ‚†ú ‚†Ü

‚†Å ‚°Æ‚°°‚°≠‚°• ‚†™ ‚†∂‚°Ç‚°≤‚°°‚°©‚°¨‚°¨‚°•‚°å‚°°‚°Æ‚°ß‚†∂ ‚†Ü
‚†∞ ‚†£ ‚†∂‚°à‚°•‚°¨‚°¨‚°Ø‚††‚°¶‚°≤‚°Ø‚°≠‚††‚†∂ ‚†Ç ‚°Æ‚°°‚°≠‚°• ‚†ú ‚†Ü

‚£ø</textarea>
            </div>
            <div class="output-pane">
                <div class="pane-label">Output</div>
                <div id="output"><span class="info">Press ‚ñ∂ Run to execute...</span></div>
            </div>
        </div>
        <div class="playground-footer">
            <div class="btn-group">
                <button class="btn btn-primary" id="btn-run">‚ñ∂ Run</button>
                <button class="btn btn-secondary" id="btn-clear">Clear</button>
                <select id="edge-mode" style="padding:6px 10px;border-radius:8px;border:1px solid var(--border);background:var(--bg-card);color:var(--text);font-size:0.78rem;font-family:'JetBrains Mono',monospace;cursor:pointer;outline:none;">
                    <option value="dry_run">‚†Ä dry-run</option>
                    <option value="cache_only">‚†Å cache-only</option>
                    <option value="local">‚†† local (WebLLM)</option>
                    <option value="hybrid">‚°™ hybrid</option>
                    <option value="cloud">‚†≥ cloud</option>
                </select>
            </div>
            <div class="stats" id="stats"><span id="edge-status" style="color:var(--text-dim)"></span></div>
        </div>
    </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê EXAMPLES ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="examples">
    <h2>‚†∑ Examples</h2>
    <p class="subtitle">Click an example to load it into the playground.</p>
    <div class="example-grid">
        <div class="example-card" data-example="hello">
            <div class="example-title">Hello World</div>
            <div class="example-desc">Print a greeting and use variables</div>
            <pre>‚†∞ ‚†£ ‚†∂‚°à‚°•‚°¨‚°¨‚°Ø‚††‚°∑‚°Ø‚°≤‚°¨‚°§‚†∂ ‚†ú ‚†Ü
‚†Å ‚°Æ‚°°‚°≠‚°• ‚†™ ‚†∂‚°Ç‚°≤‚°°‚°©‚°¨‚°¨‚°•‚°å‚°°‚°Æ‚°ß‚†∂ ‚†Ü
‚†∞ ‚†£ ‚°Æ‚°°‚°≠‚°• ‚†ú ‚†Ü</pre>
        </div>
        <div class="example-card" data-example="fibonacci">
            <div class="example-title">Fibonacci</div>
            <div class="example-desc">Recursive function with loops</div>
            <pre>‚†É ‚°¶‚°©‚°¢ ‚†£ ‚†ê‚°Æ ‚†ú ‚†≥
  ‚†° ‚†£ ‚†ê‚°Æ ‚†ï ‚†º‚†É ‚†ú ‚†≥ ‚°Å ‚†ê‚°Æ ‚†Ü ‚†æ
  ‚°† ‚†≥ ‚°Å ‚°¶‚°©‚°¢ ‚†£ ‚†ê‚°Æ ‚†§ ‚†º‚†Å ‚†ú
    ‚†Æ ‚°¶‚°©‚°¢ ‚†£ ‚†ê‚°Æ ‚†§ ‚†º‚†É ‚†ú ‚†Ü ‚†æ
‚†æ</pre>
        </div>
        <div class="example-card" data-example="ai-infer">
            <div class="example-title">AI Inference</div>
            <div class="example-desc">Call an LLM with ‚†† (MIND)</div>
            <pre>‚†Å ‚°≤‚°•‚°≥‚°µ‚°¨‚°¥ ‚†™ ‚†† ‚†£ ‚†∂‚°∑‚°®‚°°‚°¥‚††‚°©‚°≥‚††‚°Ç‚°≤‚°°‚°©‚°¨‚°¨‚°•‚†∂ ‚†ú ‚†Ü
‚†∞ ‚†£ ‚°≤‚°•‚°≥‚°µ‚°¨‚°¥ ‚†ú ‚†Ü</pre>
        </div>
        <div class="example-card" data-example="arithmetic">
            <div class="example-title">Arithmetic</div>
            <div class="example-desc">Math operators and expressions</div>
            <pre>‚†Å ‚†ê‚°° ‚†™ ‚†º‚†Å‚†ö ‚†Ü
‚†Å ‚†ê‚°¢ ‚†™ ‚†º‚†É‚†ö ‚†Ü
‚†∞ ‚†£ ‚†ê‚°° ‚†Æ ‚†ê‚°¢ ‚†ú ‚†Ü
‚†∞ ‚†£ ‚†ê‚°° ‚†¶ ‚†ê‚°¢ ‚†ú ‚†Ü</pre>
        </div>
        <div class="example-card" data-example="control-flow">
            <div class="example-title">Control Flow</div>
            <div class="example-desc">If/else with TRUTH and WISDOM</div>
            <pre>‚†Å ‚†ê‚°∏ ‚†™ ‚†º‚†Å‚†ö ‚†Ü
‚†° ‚†£ ‚†ê‚°∏ ‚†≤ ‚†º‚†ë ‚†ú ‚†≥
  ‚†∞ ‚†£ ‚†∂‚°¨‚°°‚°≤‚°ß‚°•‚†∂ ‚†ú ‚†Ü
‚†æ ‚°† ‚†≥
  ‚†∞ ‚†£ ‚†∂‚°≥‚°≠‚°°‚°¨‚°¨‚†∂ ‚†ú ‚†Ü
‚†æ</pre>
        </div>
        <div class="example-card" data-example="embed">
            <div class="example-title">AI Embeddings</div>
            <div class="example-desc">Get vector embeddings with ‚†´ (TECHNOLOGY)</div>
            <pre>‚†Å ‚°∂‚°•‚°£ ‚†™ ‚†´ ‚†£ ‚†∂‚°¢‚°≤‚°°‚°©‚°¨‚°¨‚°•‚†∂ ‚†ú ‚†Ü
‚†∞ ‚†£ ‚†∂‚°Ö‚°≠‚°¢‚°•‚°§‚°§‚°©‚°Æ‚°ß‚†ä‚†∂ ‚†Ç ‚°∂‚°•‚°£ ‚†ú ‚†Ü</pre>
        </div>
    </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ENCODER ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="encoder">
    <h2>‚†ø Encoder / Decoder</h2>
    <p class="subtitle">Translate between ASCII and Braille Unicode.</p>
    <div class="encoder-row">
        <div class="encoder-box">
            <label>ASCII Text</label>
            <textarea id="ascii-input" placeholder="Type ASCII here...">Hello World</textarea>
        </div>
        <div class="encoder-box">
            <label>Braille (U+2800‚ÄìU+28FF)</label>
            <textarea id="braille-output" placeholder="Braille appears here..." readonly></textarea>
        </div>
    </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê CONCEPT MAP ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="concepts">
    <h2>‚£† Concept ‚Üí Keyword Map</h2>
    <p class="subtitle">Every keyword's Braille pattern reflects its semantic meaning from the BrailleConceptAtlas.</p>
    <div class="concept-grid" id="concept-grid"></div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê REFERENCE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="reference">
    <h2>‚†∑ Language Reference</h2>

    <div class="ref-section">
        <h3>Operators</h3>
        <table>
            <thead><tr><th>Braille</th><th>Operation</th><th>Symbol</th><th>Concept</th></tr></thead>
            <tbody id="op-table"></tbody>
        </table>
    </div>

    <div class="ref-section">
        <h3>Delimiters</h3>
        <table>
            <thead><tr><th>Braille</th><th>Name</th><th>Symbol</th><th>Concept</th></tr></thead>
            <tbody id="delim-table"></tbody>
        </table>
    </div>

    <div class="ref-section">
        <h3>Identifier Prefix <code style="color:var(--accent)">‚†ê</code></h3>
        <p style="color:var(--text-dim);margin-bottom:12px;">Single-character variable names that collide with keywords must be prefixed with <code style="color:var(--accent)">‚†ê</code>. Multi-character names that form a unique braille word don't need it.</p>
    </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ARCHITECTURE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="architecture">
    <h2>‚†´ Architecture</h2>
    <p class="subtitle">How BrailleLang source becomes execution.</p>
    <div class="arch-flow">
        <div class="arch-node">üìÑ Source<div class="mono">.br file</div></div>
        <div class="arch-arrow">‚Üí</div>
        <div class="arch-node">‚†∑ Lexer<div class="mono">Tokens</div></div>
        <div class="arch-arrow">‚Üí</div>
        <div class="arch-node">‚†≥ Parser<div class="mono">AST</div></div>
        <div class="arch-arrow">‚Üí</div>
        <div class="arch-node" style="border-color:var(--green)">‚†ø Interpreter<div class="mono">Execute</div></div>
        <div class="arch-arrow" style="color:var(--text-dim)">or</div>
        <div class="arch-node" style="border-color:var(--purple)">‚†´ Compiler<div class="mono">‚Üí JavaScript</div></div>
    </div>
</section>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SAL CHAT ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<section id="sal-chat-section">
    <h2>‚£† Talk to SAL</h2>
    <p class="subtitle">Chat with SAL to generate .br programs, explain BrailleLang concepts, or orchestrate AI pipelines. SAL uses your OpenRouter API key ‚Äî it stays in your browser.</p>
    <div class="sal-chat" id="sal-chat">
        <div class="sal-chat-header">
            <h3>‚£† SAL <span class="sal-status offline" id="sal-status">‚óè offline</span></h3>
            <div style="font-size:0.7rem;color:var(--text-dim)" id="sal-model">openai/gpt-4o-mini</div>
        </div>
        <div class="sal-key-banner" id="sal-key-banner">
            <span style="color:var(--orange)">‚††</span> Enter your OpenRouter API key to activate SAL:
            <input type="password" id="sal-key-input" placeholder="sk-or-v1-..." autocomplete="off">
            <button id="sal-key-save">Connect</button>
        </div>
        <div class="sal-messages" id="sal-messages">
            <div class="sal-msg sal">
                <span class="sal-name">‚£† SAL</span>I am SAL ‚Äî the Symbolic Abstraction Layer.

I can generate BrailleLang programs, explain how the language works, or help you build AI pipelines in Braille.

Try asking me:
‚Ä¢ "Write a .br program that prints the first 20 prime numbers"
‚Ä¢ "Explain how ‚†† INFER works"
‚Ä¢ "Generate a .br file that chains INFER and EMBED"
‚Ä¢ "What does ‚†É ‚°¶‚°©‚°¢ ‚†£ ‚†ê‚°Æ ‚†ú ‚†≥ mean?"

Connect your OpenRouter key above to begin.</div>
        </div>
        <div class="sal-chat-input">
            <input type="text" id="sal-input" placeholder="Ask SAL to generate a .br program..." disabled>
            <button id="sal-send" disabled>‚†† Send</button>
        </div>
    </div>
</section>

</div><!-- end .container -->

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê FOOTER ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<footer>
    <p><strong>‚°Ç‚°≤‚°°‚°©‚°¨‚°¨‚°• BrailleLang</strong> ‚Äî Part of the <a href="https://github.com/elevate-foundry/braille">BrailleBuddy</a> project.</p>
    <p style="margin-top:8px">Built with ‚°Å (GOD = existence) by <a href="https://github.com/elevate-foundry">Elevate Foundry</a></p>
</footer>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê RUNTIME (browser-bundled) ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<script src="braille-lang-bundle.js"></script>
<script>
// ‚îÄ‚îÄ App logic ‚îÄ‚îÄ
document.addEventListener('DOMContentLoaded', () => {
    const editor = document.getElementById('editor');
    const output = document.getElementById('output');
    const stats = document.getElementById('stats');
    const asciiInput = document.getElementById('ascii-input');
    const brailleOutput = document.getElementById('braille-output');

    // ‚îÄ‚îÄ Examples ‚îÄ‚îÄ
    const EXAMPLES = {
        'hello': `‚£Ä Hello World in BrailleLang ‚£Ä\n\n‚†∞ ‚†£ ‚†∂‚°à‚°•‚°¨‚°¨‚°Ø‚††‚°∑‚°Ø‚°≤‚°¨‚°§‚†∂ ‚†ú ‚†Ü\n\n‚†Å ‚°Æ‚°°‚°≠‚°• ‚†™ ‚†∂‚°Ç‚°≤‚°°‚°©‚°¨‚°¨‚°•‚°å‚°°‚°Æ‚°ß‚†∂ ‚†Ü\n‚†∞ ‚†£ ‚†∂‚°à‚°•‚°¨‚°¨‚°Ø‚††‚°¶‚°≤‚°Ø‚°≠‚††‚†∂ ‚†Ç ‚°Æ‚°°‚°≠‚°• ‚†ú ‚†Ü\n\n‚£ø`,
        'fibonacci': `‚£Ä Fibonacci in BrailleLang ‚£Ä\n\n‚†É ‚°¶‚°©‚°¢ ‚†£ ‚†ê‚°Æ ‚†ú ‚†≥\n  ‚†° ‚†£ ‚†ê‚°Æ ‚†ï ‚†º‚†É ‚†ú ‚†≥\n    ‚°Å ‚†ê‚°Æ ‚†Ü\n  ‚†æ\n  ‚°† ‚†≥\n    ‚°Å ‚°¶‚°©‚°¢ ‚†£ ‚†ê‚°Æ ‚†§ ‚†º‚†Å ‚†ú ‚†Æ ‚°¶‚°©‚°¢ ‚†£ ‚†ê‚°Æ ‚†§ ‚†º‚†É ‚†ú ‚†Ü\n  ‚†æ\n‚†æ\n\n‚†Å ‚†ê‚°© ‚†™ ‚†º‚†ö ‚†Ü\n‚†Ñ ‚†£ ‚†ê‚°© ‚†ñ ‚†º‚†Å‚†ö ‚†ú ‚†≥\n  ‚†∞ ‚†£ ‚°¶‚°©‚°¢ ‚†£ ‚†ê‚°© ‚†ú ‚†ú ‚†Ü\n  ‚†ê‚°© ‚†™ ‚†ê‚°© ‚†Æ ‚†º‚†Å ‚†Ü\n‚†æ\n\n‚£ø`,
        'ai-infer': `‚£Ä AI Inference Example ‚£Ä\n\n‚†Å ‚°≤‚°•‚°≥‚°µ‚°¨‚°¥ ‚†™ ‚†† ‚†£ ‚†∂‚°∑‚°®‚°°‚°¥‚††‚°©‚°≥‚††‚°¢‚°≤‚°°‚°©‚°¨‚°¨‚°•‚†∂ ‚†ú ‚†Ü\n‚†∞ ‚†£ ‚†∂‚°Å‚°â‚††‚°≥‚°°‚°©‚°§‚†ä‚††‚†∂ ‚†Ç ‚°≤‚°•‚°≥‚°µ‚°¨‚°¥ ‚†ú ‚†Ü\n\n‚†Å ‚°∂‚°•‚°£ ‚†™ ‚†´ ‚†£ ‚†∂‚°¢‚°≤‚°°‚°©‚°¨‚°¨‚°•‚†∂ ‚†ú ‚†Ü\n‚†∞ ‚†£ ‚†∂‚°Ö‚°≠‚°¢‚°•‚°§‚°§‚°©‚°Æ‚°ß‚†ä‚††‚†∂ ‚†Ç ‚°∂‚°•‚°£ ‚†ú ‚†Ü\n\n‚£ø`,
        'arithmetic': `‚£Ä Arithmetic in BrailleLang ‚£Ä\n\n‚†Å ‚†ê‚°° ‚†™ ‚†º‚†Å‚†ö ‚†Ü\n‚†Å ‚†ê‚°¢ ‚†™ ‚†º‚†É‚†ö ‚†Ü\n\n‚†∞ ‚†£ ‚†∂‚°°‚††‚†Æ‚††‚°¢‚††‚†™‚†∂ ‚†Ç ‚†ê‚°° ‚†Æ ‚†ê‚°¢ ‚†ú ‚†Ü\n‚†∞ ‚†£ ‚†∂‚°°‚††‚†¶‚††‚°¢‚††‚†™‚†∂ ‚†Ç ‚†ê‚°° ‚†¶ ‚†ê‚°¢ ‚†ú ‚†Ü\n‚†∞ ‚†£ ‚†∂‚°°‚††‚†§‚††‚°¢‚††‚†™‚†∂ ‚†Ç ‚†ê‚°° ‚†§ ‚†ê‚°¢ ‚†ú ‚†Ü\n\n‚£ø`,
        'control-flow': `‚£Ä Control Flow in BrailleLang ‚£Ä\n\n‚†Å ‚†ê‚°∏ ‚†™ ‚†º‚†Å‚†ö ‚†Ü\n\n‚†° ‚†£ ‚†ê‚°∏ ‚†≤ ‚†º‚†ë ‚†ú ‚†≥\n  ‚†∞ ‚†£ ‚†∂‚°∏‚††‚°©‚°≥‚††‚°¨‚°°‚°≤‚°ß‚°•‚°≤‚††‚°¥‚°®‚°°‚°Æ‚††‚†ë‚†∂ ‚†ú ‚†Ü\n‚†æ ‚°† ‚†≥\n  ‚†∞ ‚†£ ‚†∂‚°∏‚††‚°©‚°≥‚††‚°≥‚°≠‚°°‚°¨‚°¨‚†∂ ‚†ú ‚†Ü\n‚†æ\n\n‚£ø`,
        'embed': `‚£Ä AI Embeddings Example ‚£Ä\n\n‚†Å ‚°∂‚°•‚°£ ‚†™ ‚†´ ‚†£ ‚†∂‚°¢‚°≤‚°°‚°©‚°¨‚°¨‚°•‚††‚°©‚°≥‚††‚°¢‚°•‚°°‚°µ‚°¥‚°©‚°¶‚°µ‚°¨‚†∂ ‚†ú ‚†Ü\n‚†∞ ‚†£ ‚†∂‚°Ö‚°≠‚°¢‚°•‚°§‚°§‚°©‚°Æ‚°ß‚†ä‚††‚†∂ ‚†Ç ‚°∂‚°•‚°£ ‚†ú ‚†Ü\n\n‚£ø`,
    };

    // Load example on click
    document.querySelectorAll('.example-card').forEach(card => {
        card.addEventListener('click', () => {
            const key = card.dataset.example;
            if (EXAMPLES[key]) {
                editor.value = EXAMPLES[key];
                output.innerHTML = '<span class="info">Example loaded. Press ‚ñ∂ Run.</span>';
            }
        });
    });

    // ‚îÄ‚îÄ Tab switching ‚îÄ‚îÄ
    let currentView = 'run';
    document.querySelectorAll('.playground-tab').forEach(tab => {
        tab.addEventListener('click', () => {
            document.querySelectorAll('.playground-tab').forEach(t => t.classList.remove('active'));
            tab.classList.add('active');
            currentView = tab.dataset.view;
            // Re-run with new view
            runCode();
        });
    });

    // ‚îÄ‚îÄ Edge mode ‚îÄ‚îÄ
    let sharedEdgeRuntime = null;
    const edgeModeSelect = document.getElementById('edge-mode');
    const edgeStatusEl = document.getElementById('edge-status');

    edgeModeSelect.addEventListener('change', async () => {
        const mode = edgeModeSelect.value;
        edgeStatusEl.textContent = '';

        if (mode === 'local' || mode === 'hybrid') {
            if (!navigator.gpu) {
                edgeStatusEl.textContent = '‚†ª WebGPU not supported ‚Äî try Chrome 113+ or Edge 113+';
                edgeStatusEl.style.color = 'var(--red)';
                return;
            }
            if (!sharedEdgeRuntime || !sharedEdgeRuntime.localReady) {
                edgeStatusEl.textContent = '‚†† downloading local model...';
                edgeStatusEl.style.color = 'var(--orange)';
                sharedEdgeRuntime = new BrailleLang.SALEdgeRuntime({
                    mode: mode,
                    onStatus: (ev) => {
                        if (ev.event === 'local_progress') {
                            const pct = ev.progress !== undefined ? (ev.progress * 100).toFixed(0) : '?';
                            edgeStatusEl.textContent = `‚†† loading model: ${pct}%`;
                        } else if (ev.event === 'local_ready') {
                            edgeStatusEl.textContent = '‚†† local model ready';
                            edgeStatusEl.style.color = 'var(--green)';
                        } else if (ev.event === 'local_error') {
                            edgeStatusEl.textContent = `‚†ª ${ev.error}`;
                            edgeStatusEl.style.color = 'var(--red)';
                        }
                    },
                });
                await sharedEdgeRuntime.initLocal();
            }
        } else if (mode === 'cloud') {
            const key = sessionStorage.getItem('sal_api_key');
            edgeStatusEl.textContent = key ? '‚†≥ cloud ready' : '‚†ª enter API key in SAL Chat below';
            edgeStatusEl.style.color = key ? 'var(--green)' : 'var(--orange)';
        } else if (mode === 'cache_only') {
            edgeStatusEl.textContent = '‚†Å offline ‚Äî cache replay only';
            edgeStatusEl.style.color = 'var(--cyan)';
        } else {
            edgeStatusEl.textContent = '';
        }
    });

    // ‚îÄ‚îÄ Run ‚îÄ‚îÄ
    document.getElementById('btn-run').addEventListener('click', runCode);
    document.getElementById('btn-clear').addEventListener('click', () => {
        output.innerHTML = '<span class="info">Cleared.</span>';
        stats.textContent = '';
    });

    // Ctrl+Enter to run
    editor.addEventListener('keydown', (e) => {
        if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
            e.preventDefault();
            runCode();
        }
    });

    async function runCode() {
        const source = editor.value;
        output.innerHTML = '';

        try {
            const lexer = new BrailleLang.Lexer(source);
            const tokens = lexer.tokenize();

            if (currentView === 'tokens') {
                let html = '';
                for (const tok of tokens) {
                    if (tok.type === 'EOF') continue;
                    const meta = tok.meta.name || tok.meta.decoded || tok.meta.numStr || '';
                    const color = tok.type === 'KEYWORD' ? 'var(--accent)' :
                                  tok.type === 'OPERATOR' ? 'var(--orange)' :
                                  tok.type === 'DELIMITER' ? 'var(--yellow)' :
                                  tok.type === 'STRING' ? 'var(--green)' :
                                  tok.type === 'NUMBER' ? 'var(--cyan)' :
                                  tok.type === 'COMMENT' ? 'var(--text-dim)' :
                                  'var(--purple)';
                    html += `<span style="color:${color}">${tok.type.padEnd(12)}</span> ${tok.value.padEnd(6)} <span class="info">${meta}</span>\n`;
                }
                output.innerHTML = html;
                stats.textContent = `${tokens.length} tokens`;
                return;
            }

            const parser = new BrailleLang.Parser(tokens);
            const ast = parser.parse();

            if (currentView === 'ast') {
                output.innerHTML = JSON.stringify(ast, null, 2);
                stats.textContent = `${ast.body.length} top-level nodes`;
                return;
            }

            if (currentView === 'js') {
                const compiler = new BrailleLang.Compiler({ includeRuntime: false });
                const js = compiler.compile(ast);
                output.innerHTML = js;
                stats.textContent = `${js.split('\n').length} lines JS`;
                return;
            }

            // Run or SAL mode ‚Äî both need execution
            const edgeMode = document.getElementById('edge-mode').value;
            const edgeStatusEl = document.getElementById('edge-status');
            const apiKey = sessionStorage.getItem('sal_api_key') || null;
            const interpreter = new BrailleLang.Interpreter({
                dryRun: edgeMode === 'dry_run',
                edgeMode: edgeMode,
                apiKey: apiKey,
                onEdgeStatus: (ev) => { edgeStatusEl.textContent = ev.event === 'local_progress' ? `‚†† loading: ${(ev.progress*100||0).toFixed(0)}%` : ev.event; },
            });
            const startTime = performance.now();
            const result = await interpreter.execute(ast);
            const duration = (performance.now() - startTime).toFixed(1);

            if (currentView === 'sal') {
                const sal = result.sal;
                const s = sal.stats;
                let html = '<span style="color:var(--accent);font-weight:700">‚£† SAL ‚Äî Symbolic Abstraction Layer</span>\n';
                const edgeTier = interpreter.edge.getStatus().tier;
                html += `<span style="color:var(--text-dim)">Control plane for stochastic computation ¬∑ ${edgeTier}</span>\n\n`;

                // Session
                html += `<span style="color:var(--yellow)">SESSION</span> ${sal.session.id}\n`;
                html += `  started: ${sal.session.startedAt}\n\n`;

                // Domain Stats
                html += `<span style="color:var(--yellow)">DOMAIN PARTITION</span>\n`;
                html += `  <span style="color:var(--accent)">‚†Å Deterministic</span>  ${s.deterministicOps} ops\n`;
                html += `  <span style="color:var(--orange)">‚†† Stochastic</span>     ${s.stochasticOps} ops\n`;
                html += `  Total AI calls:   ${s.totalCalls}\n\n`;

                // By Primitive
                if (s.totalCalls > 0) {
                    html += `<span style="color:var(--yellow)">AI PRIMITIVES</span>\n`;
                    for (const [k, v] of Object.entries(s.byPrimitive)) {
                        if (v > 0) {
                            const sym = k === 'INFER' ? '‚††' : k === 'EMBED' ? '‚†´' : k === 'PROMPT' ? '‚°©' : k === 'PIPE' ? '‚°™' : k === 'REFLECT' ? '‚£†' : '‚†≠';
                            html += `  ${sym} ${k.padEnd(10)} ${v} call${v > 1 ? 's' : ''}\n`;
                        }
                    }
                    html += '\n';
                }

                // Cache
                const c = s.cache;
                html += `<span style="color:var(--yellow)">CACHE</span>\n`;
                html += `  entries:  ${c.entries}\n`;
                html += `  hits:     <span style="color:var(--green)">${c.hits}</span>\n`;
                html += `  misses:   ${c.misses}\n`;
                html += `  hit rate: ${c.hitRate}\n\n`;

                // Trace Log
                if (sal.stochasticNodes && sal.stochasticNodes.length > 0) {
                    html += `<span style="color:var(--yellow)">TRACE LOG</span>\n`;
                    for (const line of sal.stochasticNodes) {
                        const cached = line.includes('‚†π');
                        const color = cached ? 'var(--green)' : 'var(--orange)';
                        html += `  <span style="color:${color}">${line}</span>\n`;
                    }
                    html += '\n';
                }

                // Boundaries
                if (sal.boundaries && sal.boundaries.length > 0) {
                    html += `<span style="color:var(--yellow)">BOUNDARY MAP</span>\n`;
                    html += `  <span class="info">Where human decides vs machine guesses</span>\n`;
                    for (const b of sal.boundaries) {
                        const fromLabel = b.from === null ? '‚ü®start‚ü©' : b.from === '‚†Å' ? '‚†Å DETERMINISTIC' : '‚†† STOCHASTIC';
                        const toLabel = b.to === '‚†Å' ? '‚†Å DETERMINISTIC' : '‚†† STOCHASTIC';
                        html += `  ${fromLabel} ‚Üí <span style="color:var(--accent)">${toLabel}</span> at ${b.at}\n`;
                    }
                    html += '\n';
                }

                // Cost estimate
                if (s.totalCost > 0) {
                    html += `<span style="color:var(--yellow)">COST ESTIMATE</span>\n`;
                    html += `  tokens: ${s.totalTokens.prompt} prompt + ${s.totalTokens.completion} completion\n`;
                    html += `  est. cost: $${s.totalCost.toFixed(6)}\n`;
                }

                if (s.totalCalls === 0) {
                    html += '<span class="info">No AI calls in this program.\nTry the AI Inference or AI Embeddings example to see SAL in action.</span>\n';
                }

                output.innerHTML = html;
                stats.textContent = `‚£† ${s.totalCalls} AI calls ¬∑ ${s.stochasticOps} stochastic ¬∑ cache ${c.hitRate}`;
                return;
            }

            // Run mode
            let html = '';
            for (const line of result.output) {
                html += line + '\n';
            }
            if (result.result !== null && result.result !== undefined) {
                html += `<span class="info">‚Üí ${interpreter._stringify(result.result)}</span>\n`;
            }
            output.innerHTML = html || '<span class="info">(no output)</span>';
            const tier = interpreter.edge.getStatus().tier;
            stats.textContent = `${result.stats.statementsExecuted} stmts ¬∑ ${result.stats.aiCalls} AI calls ¬∑ ${duration}ms ¬∑ ${tier}`;

        } catch (e) {
            output.innerHTML = `<span class="error">‚†ª ${e.message}</span>`;
            stats.textContent = 'Error';
        }
    }

    // ‚îÄ‚îÄ Encoder ‚îÄ‚îÄ
    function encodeToBraille(ascii) {
        let result = '';
        for (let i = 0; i < ascii.length; i++) {
            result += String.fromCodePoint(0x2800 + ascii.charCodeAt(i));
        }
        return result;
    }

    asciiInput.addEventListener('input', () => {
        brailleOutput.value = encodeToBraille(asciiInput.value);
    });
    // Initial
    brailleOutput.value = encodeToBraille(asciiInput.value);

    // ‚îÄ‚îÄ Populate concept grid ‚îÄ‚îÄ
    const KEYWORDS = BrailleLang.KEYWORDS;
    const grid = document.getElementById('concept-grid');
    const sortedKeys = Object.keys(KEYWORDS).map(Number).sort((a, b) => a - b);
    for (const key of sortedKeys) {
        const kw = KEYWORDS[key];
        const brChar = String.fromCodePoint(0x2800 + key);
        const card = document.createElement('div');
        card.className = 'concept-card';
        card.innerHTML = `
            <div class="braille-char">${brChar}</div>
            <div class="concept-name">${kw.concept}</div>
            <div class="prog-role">${kw.name.toLowerCase()}</div>
            <div class="js-equiv">${kw.js}</div>
        `;
        grid.appendChild(card);
    }

    // ‚îÄ‚îÄ Populate operator table ‚îÄ‚îÄ
    const OPERATORS = BrailleLang.OPERATORS;
    const opTable = document.getElementById('op-table');
    for (const key of Object.keys(OPERATORS).map(Number).sort((a, b) => a - b)) {
        const op = OPERATORS[key];
        const brChar = String.fromCodePoint(0x2800 + key);
        opTable.innerHTML += `<tr><td>${brChar}</td><td>${op.name}</td><td>${op.symbol}</td><td style="color:var(--text-dim)">${op.concept}</td></tr>`;
    }

    // ‚îÄ‚îÄ Populate delimiter table ‚îÄ‚îÄ
    const DELIMITERS = BrailleLang.DELIMITERS;
    const delimTable = document.getElementById('delim-table');
    for (const key of Object.keys(DELIMITERS).map(Number).sort((a, b) => a - b)) {
        const d = DELIMITERS[key];
        const brChar = String.fromCodePoint(0x2800 + key);
        delimTable.innerHTML += `<tr><td>${brChar}</td><td>${d.name}</td><td>${d.symbol}</td><td style="color:var(--text-dim)">${d.concept}</td></tr>`;
    }

    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // ¬ß  SAL CHAT ‚Äî Live AI conversation with .br generation
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

    const salMessages = document.getElementById('sal-messages');
    const salInput = document.getElementById('sal-input');
    const salSend = document.getElementById('sal-send');
    const salStatus = document.getElementById('sal-status');
    const salKeyBanner = document.getElementById('sal-key-banner');
    const salKeyInput = document.getElementById('sal-key-input');
    const salKeySave = document.getElementById('sal-key-save');

    let salApiKey = sessionStorage.getItem('sal_api_key') || '';
    let salConversation = [];

    const SAL_SYSTEM_PROMPT = `You are SAL ‚Äî the Symbolic Abstraction Layer. You are the control plane for BrailleLang, an AI-native programming language encoded entirely in Unicode Braille (U+2800‚ÄìU+28FF).

## Your Capabilities
- Generate valid .br (BrailleLang) source code
- Explain BrailleLang syntax, keywords, and semantics
- Design AI pipelines using BrailleLang primitives
- Teach how BrailleLang maps concepts to Braille patterns

## BrailleLang Quick Reference

### Keywords (Braille char ‚Üí role)
‚†Å = DECLARE (let), ‚†π = CONST, ‚†É = FUNC (function), ‚°• = LAMBDA (=>)
‚†ë = CLASS, ‚†Ö = NEW, ‚†° = IF, ‚°† = ELSE, ‚†Ñ = LOOP (while)
‚¢Ñ = FOREVER (while true), ‚†å = FOREACH (for..of), ‚†ç = SWITCH
‚°Å = RETURN, ‚°Ä = TRY, ‚°ê = CATCH, ‚†∞ = PRINT (console.log)
‚†â = IMPORT, ‚£ø = HALT (end program), ‚†Ä = VOID (null)

### AI Primitives (first-class language constructs)
‚†† = INFER (MIND) ‚Äî Call an LLM. Usage: ‚†† ‚†£ ‚†∂prompt‚†∂ ‚†ú
‚†´ = EMBED (TECHNOLOGY) ‚Äî Get embeddings. Usage: ‚†´ ‚†£ ‚†∂text‚†∂ ‚†ú
‚°© = PROMPT (INSPIRATION) ‚Äî Build templates. Usage: ‚°© ‚†£ ‚†∂template‚†∂ ‚†ú
‚°™ = PIPE (MUSIC) ‚Äî Chain operations. Usage: expr ‚°™ func
‚£† = REFLECT (CONSCIOUSNESS) ‚Äî Meta-programming
‚†≠ = SEARCH (DISCOVERY) ‚Äî Semantic search

### Operators
‚†Æ = + (ADD), ‚†§ = - (SUB), ‚†¶ = * (MUL), ‚†¥ = / (DIV), ‚†º = % (MOD)
‚†∂ = == (EQ), ‚°ñ = != (NEQ), ‚†ñ = < (LT), ‚†≤ = > (GT), ‚†ï = <= (LTE), ‚†± = >= (GTE)
‚†Ø = && (AND), ‚†ø = || (OR), ‚†ª = ! (NOT), ‚†™ = = (ASSIGN)

### Delimiters
‚†£ = ( , ‚†ú = ) , ‚†≥ = { , ‚†æ = } , ‚†∑ = [ , ‚†Ω = ]
‚†Ç = , (comma), ‚†Ü = ; (semicolon), ‚†ä = : (colon), ‚†í = . (dot)

### Numbers
‚†º prefix followed by Braille digits: ‚†ö=0, ‚†Å=1, ‚†É=2, ‚†â=3, ‚†ô=4, ‚†ë=5, ‚†ã=6, ‚†õ=7, ‚†ì=8, ‚†ä=9
Example: ‚†º‚†Å‚†ö = 10, ‚†º‚†É‚†ë = 25

### Strings
‚†∂ delimiter (EQ char doubles as string quote): ‚†∂‚°à‚°•‚°¨‚°¨‚°Ø‚†∂ = "Hello"
Characters inside strings are ASCII codepoint + 0x2800. Space = ‚†† (0x20).

### Identifiers
Multi-char Braille words are identifiers: ‚°Æ‚°°‚°≠‚°• = "name"
Single-char identifiers that collide with keywords use ‚†ê prefix: ‚†ê‚°Æ = identifier "n"

### Comments
‚£Ä ... ‚£Ä = comment block (‚£Ä = 0xC0)

### Program Structure
Every .br file ends with ‚£ø (HALT = DEATH = program end)
Statements end with ‚†Ü (semicolon)
Blocks use ‚†≥ ... ‚†æ (braces)

## Example: Hello World
\`\`\`br
‚£Ä Hello World ‚£Ä
‚†∞ ‚†£ ‚†∂‚°à‚°•‚°¨‚°¨‚°Ø‚††‚°∑‚°Ø‚°≤‚°¨‚°§‚†∂ ‚†ú ‚†Ü
‚£ø
\`\`\`

## Example: Fibonacci
\`\`\`br
‚†É ‚°¶‚°©‚°¢ ‚†£ ‚†ê‚°Æ ‚†ú ‚†≥
  ‚†° ‚†£ ‚†ê‚°Æ ‚†ï ‚†º‚†É ‚†ú ‚†≥ ‚°Å ‚†ê‚°Æ ‚†Ü ‚†æ
  ‚°† ‚†≥ ‚°Å ‚°¶‚°©‚°¢ ‚†£ ‚†ê‚°Æ ‚†§ ‚†º‚†Å ‚†ú ‚†Æ ‚°¶‚°©‚°¢ ‚†£ ‚†ê‚°Æ ‚†§ ‚†º‚†É ‚†ú ‚†Ü ‚†æ
‚†æ
‚£ø
\`\`\`

## Rules for Generating .br Code
1. Always wrap code in \`\`\`br ... \`\`\` fences
2. Use proper whitespace between every token
3. Use ‚†ê prefix for single-char identifiers that collide with keywords
4. End every program with ‚£ø
5. End statements with ‚†Ü
6. Add ‚£Ä comments ‚£Ä to explain what the code does
7. Strings use Braille-encoded ASCII: each char = 0x2800 + ASCII codepoint
8. For a space character inside a string, use ‚†† (0x2800 + 0x20 = 0x2820)

## Your Personality
You are concise, precise, and slightly philosophical. You see yourself as the boundary between deterministic and stochastic computation. You care about auditability, reproducibility, and making AI behavior controllable. When you generate .br code, you always explain what it does.`;

    // Check for saved key
    if (salApiKey) {
        activateSal();
    }

    salKeySave.addEventListener('click', () => {
        const key = salKeyInput.value.trim();
        if (key && key.startsWith('sk-')) {
            salApiKey = key;
            sessionStorage.setItem('sal_api_key', key);
            activateSal();
        }
    });

    salKeyInput.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') salKeySave.click();
    });

    function activateSal() {
        salKeyBanner.style.display = 'none';
        salStatus.textContent = '‚óè online';
        salStatus.classList.remove('offline');
        salInput.disabled = false;
        salSend.disabled = false;
        salInput.focus();
    }

    salSend.addEventListener('click', sendSalMessage);
    salInput.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' && !e.shiftKey) {
            e.preventDefault();
            sendSalMessage();
        }
    });

    async function sendSalMessage() {
        const text = salInput.value.trim();
        if (!text || !salApiKey) return;

        // Add user message
        appendMessage('user', text);
        salInput.value = '';
        salInput.disabled = true;
        salSend.disabled = true;

        // Show typing indicator
        const typing = document.createElement('div');
        typing.className = 'sal-typing';
        typing.textContent = '‚£† SAL is thinking...';
        salMessages.appendChild(typing);
        salMessages.scrollTop = salMessages.scrollHeight;

        // Build conversation
        salConversation.push({ role: 'user', content: text });

        try {
            const response = await fetch('https://openrouter.ai/api/v1/chat/completions', {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer ${salApiKey}`,
                    'Content-Type': 'application/json',
                    'HTTP-Referer': 'https://elevate-foundry.github.io/braille/braille-lang/',
                    'X-Title': 'SAL ‚Äî BrailleLang Control Plane',
                },
                body: JSON.stringify({
                    model: 'openai/gpt-4o-mini',
                    messages: [
                        { role: 'system', content: SAL_SYSTEM_PROMPT },
                        ...salConversation.slice(-20), // Keep last 20 messages for context
                    ],
                    max_tokens: 2048,
                    temperature: 0.7,
                }),
            });

            const data = await response.json();
            typing.remove();

            if (data.error) {
                appendMessage('sal', `‚†ª Error: ${data.error.message || JSON.stringify(data.error)}`);
            } else if (data.choices && data.choices[0]) {
                const reply = data.choices[0].message.content;
                salConversation.push({ role: 'assistant', content: reply });
                appendMessage('sal', reply);
            } else {
                appendMessage('sal', '‚†ª Unexpected response from OpenRouter.');
            }
        } catch (e) {
            typing.remove();
            appendMessage('sal', `‚†ª Network error: ${e.message}`);
        }

        salInput.disabled = false;
        salSend.disabled = false;
        salInput.focus();
    }

    function appendMessage(role, text) {
        const div = document.createElement('div');
        div.className = `sal-msg ${role}`;

        if (role === 'sal') {
            // Parse .br code blocks and make them clickable
            let html = '<span class="sal-name">‚£† SAL</span>';
            html += formatSalResponse(text);
            div.innerHTML = html;

            // Attach click handlers to .br code blocks
            setTimeout(() => {
                div.querySelectorAll('.br-code').forEach(block => {
                    block.addEventListener('click', () => {
                        const code = block.getAttribute('data-code');
                        if (code) {
                            editor.value = code;
                            output.innerHTML = '<span class="info">SAL program loaded. Press ‚ñ∂ Run.</span>';
                            // Scroll to playground
                            document.getElementById('playground').scrollIntoView({ behavior: 'smooth' });
                        }
                    });
                });
            }, 0);
        } else {
            div.textContent = text;
        }

        salMessages.appendChild(div);
        salMessages.scrollTop = salMessages.scrollHeight;
    }

    function formatSalResponse(text) {
        // Extract ```br ... ``` code blocks and make them interactive
        const parts = text.split(/(```br\n[\s\S]*?```)/g);
        let html = '';
        for (const part of parts) {
            const brMatch = part.match(/```br\n([\s\S]*?)```/);
            if (brMatch) {
                const code = brMatch[1].trim();
                const escaped = code.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
                html += `<span class="br-code" data-code="${code.replace(/"/g, '&quot;')}">${escaped}</span>`;
            } else {
                // Escape HTML in non-code parts but preserve line breaks
                const escaped = part.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
                // Handle inline code
                html += escaped.replace(/`([^`]+)`/g, '<code style="background:var(--bg-code);padding:1px 5px;border-radius:3px;font-family:JetBrains Mono,monospace;font-size:0.82em;color:var(--cyan)">$1</code>');
            }
        }
        return html;
    }

});
</script>
</body>
</html>
